
```{r}
library(shiny)
library(ggplot2)
library(dplyr)
library(plotly)

ui <- fluidPage(
  tabsetPanel(
    tabPanel("Interactive Time Series", plotlyOutput("interactive_time_series")),
    tabPanel("Interactive Avg Daily Diff by Weekday", plotlyOutput("interactive_bar_plot")),
    tabPanel("Interactive Boxplot by Station", plotlyOutput("interactive_box_plot")),
    tabPanel("Interactive Histogram of Daily Diff", plotlyOutput("interactive_histogram"))
  )
)

server <- function(input, output) {
  
  output$interactive_time_series <- renderPlotly({
    p <- ggplot(total_citi_bike_df, aes(x = date)) + 
      geom_line(aes(y = startcount, color = "Start Count")) +
      geom_line(aes(y = endcount, color = "End Count")) +
      labs(y = "Count", title = "Time Series of Bike Counts") +
      theme_minimal()
    
    ggplotly(p, tooltip = c("y", "color"))
  })
  
  output$interactive_bar_plot <- renderPlotly({
    avg_diff_by_weekday <- total_citi_bike_df %>%
      group_by(weekday) %>%
      summarise(avg_day_diff = mean(day_diff))
    
    p <- ggplot(avg_diff_by_weekday, aes(x = weekday, y = avg_day_diff)) + 
      geom_bar(stat = "identity") +
      labs(y = "Average Daily Difference", title = "Average Daily Difference by Weekday") +
      theme_minimal()
    
    ggplotly(p, tooltip = "y")
  })
  
  output$interactive_box_plot <- renderPlotly({
    p <- ggplot(total_citi_bike_df, aes(x = factor(station_id), y = startcount)) +
      geom_boxplot() +
      labs(y = "Start Count", title = "Boxplot of Start Count by Station") +
      theme_minimal()
    
    ggplotly(p, tooltip = "y")
  })
  
  output$interactive_histogram <- renderPlotly({
    p <- ggplot(total_citi_bike_df, aes(x = day_diff)) +
      geom_histogram(binwidth = 10, fill = "blue", color = "black", alpha = 0.7) +
      labs(y = "Frequency", title = "Histogram of Daily Difference") +
      theme_minimal()
    
    ggplotly(p, tooltip = "count")
  })
  
}

shinyApp(ui, server)

```

